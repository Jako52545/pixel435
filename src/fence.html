<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fence</title>
    <style>
        button {
            font-size: 18px;
            padding: 3px;
            margin: 5px;
            border-radius: 1px;
            cursor: pointer;
            background-color: orange;
            transition: background-color 0.5s ease;
        }

        button:hover {
            background-color: rgb(209, 150, 40)
        }

        body {
            background-image: url('../assets/fence.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif
        }

        #container {
            margin-top: 5px;
            width: 500px;
            border-radius: 5px;
            padding: 3px;
            background-color: rgba(197, 195, 213, 0.5);
        }

        #burnCount {
            font-size: 20px;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div id="container">
        <h2>Burn down Jame's fence simulator</h2>
        <div id="burnCount"></div>
        <button id="burn">Burn</button>
        <h3>Frank's store of different shenanigans</h4>
        <button id="upgrade">More heat: 100 ashes</button>
        <br>
        <button id="auto">Automatic burner: 10000 ashes</button>
        <button id="burner-upgrade">Upgrade automatic burner: 999 ashes</button>
        <br>
        <a href="../index.html">Back to home page</a>
    </div>
    <script>
        let automatic = localStorage.getItem('auto') || false
        let power = parseInt(localStorage.getItem('power')) || 0
        let autoButton = document.getElementById('auto')
        let burnButton = document.getElementById('burn')
        let count = document.getElementById('burnCount')
        let upgrade1Button = document.getElementById('upgrade')
        let savedBurns = parseInt(localStorage.getItem('burns')) || 0
        let burns = savedBurns
        let counter = power + 1
        let burnerPower = parseInt(localStorage.getItem('burner') || 0) + 100
        let burnerUpgrade = document.getElementById('burner-upgrade')
        
        function updateCounter() {
            count.innerHTML = `Ashes: ${burns}`
            counter = power + 1
        }

        function save() {
            localStorage.setItem('burns', burns)
            localStorage.setItem('power', power)
            localStorage.setItem('auto', automatic)
            localStorage.setItem('burner', burnerPower - 100)
        }

        burnButton.onclick = () => {
            burnButton.disabled = true

            setTimeout(() => {
                burns += counter
                updateCounter()
                save()
                burnButton.disabled = false
            }, 50)
        }

        upgrade1Button.onclick = () => {
            // stop the burns from going negative
            if (burns > 99) {
                burns -= 100
                power++
                updateCounter()
                save()
            } else {
                console.log('not enough burns')
            }
        }

        autoButton.onclick = () => {
            if (burns > 9999) {
                burns -= 10000
                automatic = true
                autoButton.disabled = true
                burnerUpgrade.disabled = false

                setInterval(() => {
                    burns += burnerPower
                    updateCounter()
                    save()
                }, 1000)

                save()
                updateCounter()
            }
        }

        burnerUpgrade.onclick = () => {
            if (burns > 998) {
                burnerPower += 5
                burns -= 999
                save()
                updateCounter()
            }
        }

        updateCounter()

        if (automatic === 'true') {
            autoButton.disabled = true

            setInterval(() => {
                burns += burnerPower
                updateCounter()
                save()
            }, 1000)

        } else {
            burnerUpgrade.disabled = true
        }
    </script>
</body>
</html>